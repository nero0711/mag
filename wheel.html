<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö—Ä—É—Ç–∏–ª–∫–∞</title>
  <style>
    :root {
      --w: 320px;
      --h: 450px;
      --bg: #d0f0e2;           /* –§–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
      --panel: #255853;        /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –ø–∞–Ω–µ–ª–∏ */
      --muted: #64748b;
      --text: #e5e7eb;
      --accent: #22c55e;       /* –ó–µ–ª—ë–Ω—ã–π –∞–∫—Ü–µ–Ω—Ç */
      --accent-2: #ef4444;
      --border: #1f2937;
      --btn: #334155;
      --btn-hover: #475569;
      --game-bg: #94A7A3;      /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∏–≥—Ä—ã */
      --shadow-light: #A6BCB7;
      --shadow-dark: #255853;
      --control-bg: #448778;
    }

    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: var(--bg);
      font-family: 'Arial', sans-serif;
      user-select: none;
    }

    .container {
      width: 320px;
      height: var(--h);
      background-color: var(--game-bg);
      border: 2px solid #777777;
      border-radius: 50px;
      box-shadow:
        inset 2px 2px 0px 2px var(--shadow-light),
        3px 20px 0px #5B7A78,
        9px 10px 0px #5B7A78,
        0px 40px 0px var(--shadow-dark),
        9px 40px 0px var(--shadow-dark);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0px 20px 0px 20px;
      box-sizing: border-box;
      overflow: hidden;
      position: relative;
      color: white;
    }

    .title {
      font-size: 26px;
      font-weight: 700;
      margin: 0 0 20px 0;
      color: #1a3a32;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }

    .wheel {
      width: 100%;
      height: 280px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
      border-radius: 45px;
      background: #000;
      box-shadow: inset 2px 2px 0px 2px #5E7A77;
      padding: 10px;
      box-sizing: border-box;
    }

    .slot {
      width: 80%;
      height: 50px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 32px;
      color: white;
      background: #111;
      border-radius: 12px;
      margin: 4px 0;
      transition: transform 0.1s, filter 0.2s;
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
    }

    .slot.blur {
      filter: blur(2px);
      opacity: 0.2;
    }

    .highlight-container {
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      z-index: 2;
    }

    .highlight {
      width: 60px;
      height: 60px;
      font-size: 32px;
      background: #dadada;
      border: 2px solid #fff;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      box-shadow: 0 0 10px rgba(47, 152, 86, 0.6);
      animation: pulse 1.5s infinite alternate;
    }

    @keyframes pulse {
      from { box-shadow: 0 0 10px rgba(34, 197, 94, 0.6); }
      to { box-shadow: 0 0 20px rgba(34, 197, 94, 0.9); }
    }

    .highlight-container::before {
      content: "‚Üí";
      font-size: 24px;
      color: #22c55e;
      font-weight: bold;
      text-shadow: 0 0 5px rgba(34, 197, 94, 0.8);
    }

    button {
        padding: 25px 0px 25px 0px;
        width: 100%;
        font-size: 25px;
        background-color: #448778;
        color: white;
        border: 1px solid #4d4d4d;
        border-radius: 50px;
        cursor: pointer;
        transition: background-color 0.3s;
        box-shadow: 0px 7px 0px #255853, inset 2px 2px 0px 2px #4E917F;
        margin: 25px 0px 25px 0px;
    }

    button:disabled {
        background-color: #255853;
        cursor: not-allowed;
        box-shadow: 0px 8px 0px #448778;
    }

    .button:active {
      transform: translateY(4px);
      box-shadow: 0px 3px 0px #255853;
    }

    #qr {
      margin-top: 20px;
      display: none;
      width: 280px;
      height: 280px;
      border-radius: 20px;
      box-shadow: 5px 5px 0px #5B7A78;
      opacity: 0;
      transition: opacity 0.8s ease-in-out;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title"></div>

    <div class="wheel" id="wheel">
      <div class="slot blur" id="slot1">üÖæÔ∏è</div>
      <div class="slot blur" id="slot2">üÖæÔ∏è</div>

      <div class="highlight-container">
        <div class="highlight" id="slot3">üÖæÔ∏è</div>
      </div>

      <div class="slot blur" id="slot4">üÖæÔ∏è</div>
      <div class="slot blur" id="slot5">üÖæÔ∏è</div>
    </div>

    <button class="button" id="spinBtn">–ö—Ä—É—Ç–∏—Ç—å</button>
    <img src="source_qr.png" alt="QR" id="qr">
  </div>

  <script>
    const wheelSlots = [
      'üòÄ','üòÉ','üòÑ','üòÅ','‚úÖ',
      'üòÅ','üòÜ','ü•≤','üòö','üòõ',
      'ü•π','ü§£','ü•∞','üòù','üòã',
      'üòÖ','üò©','üòò','üòú','üòç',
      'üôÇ','üòä','üòó','ü§®','üòå',
      'üòÇ','üòá','üòô','ü§™','üòâ'
    ];

    const slotElements = [
      document.getElementById('slot1'),
      document.getElementById('slot2'),
      document.getElementById('slot3'),
      document.getElementById('slot4'),
      document.getElementById('slot5')
    ];

    const highlightSlot = document.getElementById('slot3');
    const spinBtn = document.getElementById('spinBtn');
    const wheel = document.getElementById('wheel');
    const qr = document.getElementById('qr');

    let currentIndex = 0;
    let isSpinning = false;
    let autoSpinInterval;

    autoSpinInterval = setInterval(() => {
      if (!isSpinning) {
        currentIndex = (currentIndex + 1) % wheelSlots.length;
        updateSlots();
      }
    }, 3000);

    function updateSlots() {
      for (let i = 0; i < 5; i++) {
        let idx = (currentIndex + i - 2 + wheelSlots.length) % wheelSlots.length;
        slotElements[i].textContent = wheelSlots[idx];
        if (i !== 2) {
          slotElements[i].classList.add('blur');
        } else {
          slotElements[i].classList.remove('blur');
        }
      }
    }

    function spinWheel() {
      if (isSpinning) return;
      isSpinning = true;
      spinBtn.disabled = true;
      const wasSadFace = highlightSlot.textContent === 'üòç';
      let totalSteps;
      let targetIndex;

      if (wasSadFace) {
        const targetSlotIndex = wheelSlots.indexOf('‚úÖ');
        if (targetSlotIndex === -1) {
          console.error('‚úÖ not found in wheelSlots');
          isSpinning = false;
          spinBtn.disabled = false;
          return;
        }
        const stepsToTarget = (targetSlotIndex - currentIndex + wheelSlots.length) % wheelSlots.length;
        totalSteps = 2 * wheelSlots.length + stepsToTarget;
        targetIndex = targetSlotIndex;
      } else {
        const allowedIndices = wheelSlots
          .map((symbol, index) => ({ symbol, index }))
          .filter(item => item.symbol !== 'üòç')
          .map(item => item.index);
        const randomTargetIndex = allowedIndices[Math.floor(Math.random() * allowedIndices.length)];
        const stepsToTarget = (randomTargetIndex - currentIndex + wheelSlots.length) % wheelSlots.length;
        totalSteps = 2 * wheelSlots.length + stepsToTarget;
        targetIndex = randomTargetIndex;
      }

      const totalDuration = 4000;
      const startTime = performance.now();
      let lastStep = 0;

      function animate(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / totalDuration, 1);
        const easedProgress = 1 - Math.pow(1 - progress, 3);
        const currentStep = Math.floor(easedProgress * totalSteps);

        if (currentStep !== lastStep) {
          const delta = currentStep - lastStep;
          currentIndex = (currentIndex + delta) % wheelSlots.length;
          updateSlots();
          lastStep = currentStep;
        }

        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          currentIndex = targetIndex;
          updateSlots();

          isSpinning = false;

          if (highlightSlot.textContent === '‚úÖ') {
            onWin();
          } else {
            spinBtn.disabled = false;
          }
        }
      }

      requestAnimationFrame(animate);
    }

    function onWin() {
      clearInterval(autoSpinInterval);
      wheel.style.display = 'none';
      spinBtn.style.display = 'none';
      qr.style.display = 'block';
      qr.style.opacity = '1';
    }

    spinBtn.addEventListener('click', spinWheel);
    updateSlots();
  </script>
</body>
</html>
